<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ZipArchive.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff" leftmargin="32" marginwidth="32" topmargin="32" marginheight="32">
<!-- Generated by Doxygen 1.8.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_275089585c7fc1b5fd5d7d42c69cb1da.html">D:</a></li><li class="navelem"><a class="el" href="dir_65277ed72a50c0b7b96afa758d6772e5.html">System</a></li><li class="navelem"><a class="el" href="dir_dc7073d465f8637523b42359128a360d.html">Temp</a></li><li class="navelem"><a class="el" href="dir_50c72084529e8ff67e4fbf3e8c8d6e39.html">ZipArchive-Deploy</a></li><li class="navelem"><a class="el" href="dir_3952c09a8cd4f5090ee3bfa1a41d254f.html">f4093ed7-a82d-4d2e-b873-c31582fa71cb</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ZipArchive.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ZipArchive_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// This source file is part of the ZipArchive library source distribution and</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// is Copyrighted 2000 - 2013 by Artpol Software - Tadeusz Dracz</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This program is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// modify it under the terms of the GNU General Public License</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// as published by the Free Software Foundation; either version 2</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// For the licensing details refer to the License.txt file.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// Web Site: http://www.artpol-software.com</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"></span><span class="comment">// Check the site http://www.artpol-software.com for the updated version of the library.</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//   </span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// The following information files are distributed along with this library:</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//  License.txt  - licensing information</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//  Appnote.txt  - details on the zip format</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//       ( also available at ftp://ftp.pkware.com/appnote.zip)</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#if !defined(ZIPARCHIVE_ZIPARCHIVE_DOT_H)</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define ZIPARCHIVE_ZIPARCHIVE_DOT_H</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#if (_MSC_VER &gt; 1000) &amp;&amp; (defined ZIP_HAS_DLL)</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor"></span><span class="preprocessor"> #pragma warning (push)</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor"></span><span class="preprocessor"> #pragma warning( disable : 4251 ) // needs to have dll-interface to be used by clients of class</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor"></span><span class="preprocessor"> #pragma warning( disable : 4275 ) // non dll-interface class used as base for dll-interface</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;_features.h&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ZipException_8h.html">ZipException.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;ZipAutoBuffer.h&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ZipCentralDir_8h.html">ZipCentralDir.h</a>&quot;</span> </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ZipStorage_8h.html">ZipStorage.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ZipPathComponent_8h.html">ZipPathComponent.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;ZipString.h&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;ZipExport.h&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ZipCryptograph_8h.html">ZipCryptograph.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="FileFilter_8h.html">FileFilter.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DirEnumerator_8h.html">DirEnumerator.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ZipCompressor_8h.html">ZipCompressor.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;ZipCallbackProvider.h&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BitFlag_8h.html">BitFlag.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#define ZIP_DEFAULT_CODE_PAGE UINT(-1)</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="code" href="structCZipAddNewFileInfo.html">   63</a></span>&#160;<span class="keyword">struct </span>ZIP_API <a class="code" href="structCZipAddNewFileInfo.html">CZipAddNewFileInfo</a></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="code" href="structCZipAddNewFileInfo.html#acddea5d82dbbe1696714dd2783aeef1b">   74</a></span>&#160; <a class="code" href="structCZipAddNewFileInfo.html">CZipAddNewFileInfo</a>(LPCTSTR lpszFilePath, <span class="keywordtype">bool</span> bFullPath = <span class="keyword">true</span>)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  Defaults();</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  m_szFilePath = lpszFilePath;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  m_bFullPath = bFullPath;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="code" href="structCZipAddNewFileInfo.html#a9627213821839603a929eaa9c6ca7d59">   90</a></span>&#160; <a class="code" href="structCZipAddNewFileInfo.html">CZipAddNewFileInfo</a>(LPCTSTR lpszFilePath, LPCTSTR lpszFileNameInZip)</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  Defaults();</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  m_szFilePath = lpszFilePath;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  m_szFileNameInZip = lpszFileNameInZip;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="code" href="structCZipAddNewFileInfo.html#af8faba175a235a9756953434dd018ad6">  106</a></span>&#160; <a class="code" href="structCZipAddNewFileInfo.html">CZipAddNewFileInfo</a>(CZipAbstractFile* pFile, LPCTSTR lpszFileNameInZip)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  Defaults();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  m_pFile = pFile;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  m_szFileNameInZip = lpszFileNameInZip;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="code" href="structCZipAddNewFileInfo.html#acd656262c3f3f2c454c80b3f28f16d3f">  123</a></span>&#160; CZipAbstractFile* <a class="code" href="structCZipAddNewFileInfo.html#acd656262c3f3f2c454c80b3f28f16d3f">m_pFile</a>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="code" href="structCZipAddNewFileInfo.html#a54e49f36a7dc9e1e6f16651e8e5c44e2">  130</a></span>&#160; CZipString <a class="code" href="structCZipAddNewFileInfo.html#a54e49f36a7dc9e1e6f16651e8e5c44e2">m_szFilePath</a>;  </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="code" href="structCZipAddNewFileInfo.html#a85d4df19e154636eedd209397c00574d">  137</a></span>&#160; CZipString <a class="code" href="structCZipAddNewFileInfo.html#a85d4df19e154636eedd209397c00574d">m_szFileNameInZip</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="code" href="structCZipAddNewFileInfo.html#a5deb0d0300f95c700473170ec9902756">  151</a></span>&#160; <span class="keywordtype">bool</span> <a class="code" href="structCZipAddNewFileInfo.html#a5deb0d0300f95c700473170ec9902756">m_bFullPath</a>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="code" href="structCZipAddNewFileInfo.html#a9a636d5fec970c50215b0a4537539070">  157</a></span>&#160; <span class="keywordtype">int</span> <a class="code" href="structCZipAddNewFileInfo.html#a9a636d5fec970c50215b0a4537539070">m_iComprLevel</a>;    </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="code" href="structCZipAddNewFileInfo.html#a987a635097bd3c9da5ec206fbe0dffec">  163</a></span>&#160; <a class="code" href="structZipArchiveLib_1_1CBitFlag.html">ZipArchiveLib::CBitFlag</a> <a class="code" href="structCZipAddNewFileInfo.html#a987a635097bd3c9da5ec206fbe0dffec">m_iSmartLevel</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="code" href="structCZipAddNewFileInfo.html#a8c754f0148639ec63dab981ea111d662">  182</a></span>&#160; ZIP_INDEX_TYPE <a class="code" href="structCZipAddNewFileInfo.html#a8c754f0148639ec63dab981ea111d662">m_uReplaceIndex</a>;  </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="code" href="structCZipAddNewFileInfo.html#a90629c2d180ad6c95369e09dda252a5d">  187</a></span>&#160; <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structCZipAddNewFileInfo.html#a90629c2d180ad6c95369e09dda252a5d">m_nBufSize</a>;  </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; <span class="keywordtype">void</span> Defaults();</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;};</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="keyword">class </span>ZIP_API <a class="code" href="classCZipAddFilesEnumerator.html">CZipAddFilesEnumerator</a>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="code" href="classCZipArchive.html">  201</a></span>&#160;<span class="keyword">class </span>ZIP_API <a class="code" href="classCZipArchive.html" title="Represents a zip archive file. ">CZipArchive</a>  </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;{ </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> m_gszCopyright[];</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> m_gszVersion[];</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; <a class="code" href="classCZipArchive.html" title="Represents a zip archive file. ">CZipArchive</a>();</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; <span class="keyword">virtual</span> ~<a class="code" href="classCZipArchive.html" title="Represents a zip archive file. ">CZipArchive</a>();</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; <span class="keywordtype">bool</span> SetPassword(LPCTSTR lpszPassword = NULL, UINT codePage = ZIP_DEFAULT_CODE_PAGE); </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; CZipString GetPassword()<span class="keyword">const</span> ;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a4df613845e1f96033e1caa0bd512a988">  265</a></span>&#160; <span class="keywordtype">bool</span> WillEncryptNextFile()<span class="keyword"> const</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keywordflow">return</span> m_pszPassword.GetSize() != 0 &amp;&amp; m_iEncryptionMethod != <a class="code" href="classCZipCryptograph.html#ab3e0a46c0680f616ccf7a163f4f40332aa72fc2366adc9ba8d011e038717c4f28" title="Indicates no encryption.">CZipCryptograph::encNone</a>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; <span class="keywordtype">bool</span> SetEncryptionMethod(<span class="keywordtype">int</span> iEncryptionMethod = <a class="code" href="classCZipCryptograph.html#ab3e0a46c0680f616ccf7a163f4f40332a3acf6a872aa7b3c932d9e8179ecbeb6a" title="The traditional zip encryption.">CZipCryptograph::encStandard</a>);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a80a0bdaabef1438ae5ac3140385d3c4a">  308</a></span>&#160; <span class="keywordtype">int</span> GetEncryptionMethod()<span class="keyword"> const</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">return</span> m_iEncryptionMethod;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno"><a class="code" href="classCZipArchive.html#aa83d0131026c8d9a9fb83707a3356ce4">  341</a></span>&#160; <span class="keywordtype">bool</span> EncryptFile(ZIP_INDEX_TYPE uIndex)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  CZipIndexesArray aIndexes;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  aIndexes.Add(uIndex);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordflow">return</span> EncryptFilesInternal(&amp;aIndexes);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a491293bc698235d185543301103bd3d2">  376</a></span>&#160; <span class="keywordtype">bool</span> EncryptFiles(CZipIndexesArray &amp;aIndexes)</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">return</span> EncryptFilesInternal(&amp;aIndexes);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00406"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a6e42b43751eafe1fd87c73043096ae25">  406</a></span>&#160; <span class="keywordtype">bool</span> EncryptAllFiles()</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordflow">return</span> EncryptFilesInternal(NULL);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; <span class="keywordtype">bool</span> SetCompressionMethod(WORD uCompressionMethod = <a class="code" href="classCZipCompressor.html#ab68b3b3437bcae944edd4a20ab1ca777a5fd59222ad89ea04a5291654ea63cad5" title="The deflate compression method.">CZipCompressor::methodDeflate</a>);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a73496c42f9eee22914083fd3bfe3b596">  447</a></span>&#160; WORD GetCompressionMethod()<span class="keyword"> const</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">return</span> m_uCompressionMethod;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno"><a class="code" href="classCZipArchive.html#aaa14ea39420cb30f3ac5bfe0adfea8ad">  471</a></span>&#160; <span class="keywordtype">void</span> SetCompressionOptions(<a class="code" href="structCZipCompressor_1_1COptions.html">CZipCompressor::COptions</a>* pOptions)</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keywordflow">if</span> (m_iFileOpened)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;   ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : The options will have no effect on the current file processing.\n&quot;</span>);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  m_compressorsOptions.Set(pOptions);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; <span class="keywordtype">void</span> SetAdvanced(<span class="keywordtype">int</span> iWriteBuffer = 65536, <span class="keywordtype">int</span> iGeneralBuffer = 65536, <span class="keywordtype">int</span> iSearchBuffer = 32768);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a959036df52c025afe050e22299d1c533">  516</a></span>&#160; <span class="keywordtype">void</span> GetAdvanced(<span class="keywordtype">int</span>* piWriteBuffer = NULL, <span class="keywordtype">int</span>* piGeneralBuffer = NULL, <span class="keywordtype">int</span>* piSearchBuffer= NULL)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keywordflow">if</span> (piWriteBuffer)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;   *piWriteBuffer =  m_storage.m_iWriteBufferSize;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="keywordflow">if</span> (piGeneralBuffer)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   *piGeneralBuffer = m_iBufferSize;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keywordflow">if</span> (piSearchBuffer)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   *piSearchBuffer = m_storage.m_iLocateBufferSize;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno"><a class="code" href="classCZipArchive.html#aa5db2354fbabea4a82bb1e242caebf7f">  547</a></span>&#160; <span class="keywordtype">void</span> SetCallback(<a class="code" href="structCZipActionCallback.html">CZipActionCallback</a>* pCallback = NULL, <span class="keywordtype">int</span> iWhich = <a class="code" href="structCZipActionCallback.html#a987550875690c39c4278cc65e4f11734a87a69af5f658de0921a8c3729ed37ecb">CZipActionCallback::cbAll</a>)</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  m_callbacks.Set(pCallback, iWhich);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00568"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a068c632e914649df6986477b85eee0b9">  568</a></span>&#160; <a class="code" href="structCZipActionCallback.html">CZipActionCallback</a>* GetCallback(<a class="code" href="structCZipActionCallback.html#a987550875690c39c4278cc65e4f11734">CZipActionCallback::CallbackType</a> iWhich)</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">return</span> m_callbacks.Get(iWhich);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno"><a class="code" href="classCZipArchive.html#ab8337e8900ff2b4d0780f277f431e6d9">  579</a></span>&#160; <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#ab8337e8900ff2b4d0780f277f431e6d9">SegmCallbackType</a></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; {</div>
<div class="line"><a name="l00581"></a><span class="lineno"><a class="code" href="classCZipArchive.html#ab8337e8900ff2b4d0780f277f431e6d9a47dca8db71d2aa0205ce47b1d10efe35">  581</a></span>&#160;  scSpan = 0x01,    </div>
<div class="line"><a name="l00582"></a><span class="lineno"><a class="code" href="classCZipArchive.html#ab8337e8900ff2b4d0780f277f431e6d9a565f74546f3c9eb4aac6e0692817b9db">  582</a></span>&#160;  scSplit = 0x02,    </div>
<div class="line"><a name="l00583"></a><span class="lineno"><a class="code" href="classCZipArchive.html#ab8337e8900ff2b4d0780f277f431e6d9a1f057a40aadcbf5ca7b4b551ac916ca5">  583</a></span>&#160;  scAll = scSpan | scSplit </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; };</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; <span class="keywordtype">void</span> SetSegmCallback(<a class="code" href="structCZipSegmCallback.html">CZipSegmCallback</a>* pCallback = NULL, <span class="keywordtype">int</span> callbackType = scSpan);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div>
<div class="line"><a name="l00624"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a0cab93e835c4d5b3309f5672416f673b">  624</a></span>&#160; <span class="keywordtype">bool</span> SetSplitNamesHandler(<a class="code" href="classCZipSplitNamesHandler.html">CZipSplitNamesHandler</a>&amp; names)</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="keywordflow">return</span> SetSplitNamesHandler(&amp;names, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a35f9982583097cbbf23892e46196060e">  648</a></span>&#160; <span class="keywordtype">bool</span> SetSplitNamesHandler(<a class="code" href="classCZipSplitNamesHandler.html">CZipSplitNamesHandler</a>* pNames, <span class="keywordtype">bool</span> bAutoDelete = <span class="keyword">true</span>)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; {</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordflow">return</span> m_storage.SetSplitNamesHandler(pNames, bAutoDelete);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; }</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdb">  658</a></span>&#160; <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdb">OpenMode</a></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; {</div>
<div class="line"><a name="l00660"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdba7932d6a8eb7d436b5003d0e2d6c10b7e">  660</a></span>&#160;  zipOpen    = 0x0001,    </div>
<div class="line"><a name="l00661"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdbabf5fdf56b9ed21bb4439d72efbefb13d">  661</a></span>&#160;  zipOpenReadOnly  = zipOpen | 0x0002,  </div>
<div class="line"><a name="l00662"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdbadcf20d3cf869207a53206f415bf5e1f5">  662</a></span>&#160;  zipCreate   = 0x0004,    </div>
<div class="line"><a name="l00663"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdba16ee2398b435a10f65b718e0ec1abd73">  663</a></span>&#160;  zipCreateAppend  = zipCreate | 0x0008, </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  zipModeSplit  = 0x0100, <span class="comment">// For the internal use only.</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  zipModeBinSplit  = 0x0200, <span class="comment">// For the internal use only.</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  zipModeSpan   = 0x0400, <span class="comment">// For the internal use only.</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  zipModeSegmented = zipModeSplit | zipModeBinSplit | zipModeSpan, <span class="comment">// For the internal use only.</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;</div>
<div class="line"><a name="l00670"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdba21ed466fd325c084dc196c288e08c0a4">  670</a></span>&#160;  zipCreateSplit  = zipCreate | zipModeSplit, </div>
<div class="line"><a name="l00671"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdbaa8db695ef08d26c03973af199a581a98">  671</a></span>&#160;  zipCreateBinSplit = zipCreate | zipModeBinSplit, </div>
<div class="line"><a name="l00672"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdbaffe1f8b7e73ce4f7db7702b2a22d6c22">  672</a></span>&#160;  zipCreateSpan  = zipCreate | zipModeSpan, </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div>
<div class="line"><a name="l00674"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdba9a3e056d5fd80273cf6e5818faf22ef3">  674</a></span>&#160;  zipOpenSplit  = zipOpenReadOnly | zipModeSplit, </div>
<div class="line"><a name="l00675"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a5d80f4df2aa34edda55d5fb98cffafdbaf374a2121958af7bbc33da4620b0d414">  675</a></span>&#160;  zipOpenBinSplit = zipOpenReadOnly | zipModeBinSplit </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; };</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; <span class="keywordtype">bool</span> Open(LPCTSTR szPathName, <span class="keywordtype">int</span> iMode = zipOpen, ZIP_SIZE_TYPE uVolumeSize = 0);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; <span class="keywordtype">bool</span> Open(CZipAbstractFile&amp; af, <span class="keywordtype">int</span> iMode = zipOpen, <span class="keywordtype">bool</span> bAutoClose = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; <span class="keywordtype">bool</span> OpenFrom(<a class="code" href="classCZipArchive.html" title="Represents a zip archive file. ">CZipArchive</a>&amp; zip, CZipAbstractFile* pArchiveFile = NULL, <span class="keywordtype">bool</span> bAllowNonReadOnly = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; <span class="keywordtype">void</span> SetRootPath(LPCTSTR szPath = NULL);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div>
<div class="line"><a name="l00809"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a63d53a5a802a38ff64f796b12f7c374b">  809</a></span>&#160; CZipString GetRootPath()<span class="keyword">const </span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keywordflow">return</span> m_szRootPath;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div>
<div class="line"><a name="l00821"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669f">  821</a></span>&#160; <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669f">Smartness</a></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; {</div>
<div class="line"><a name="l00823"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fa4786128054ff353ce917e04c049c9b20">  823</a></span>&#160;  zipsmLazy   = 0x0000,  </div>
<div class="line"><a name="l00824"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669faf42c270f87cc3c94e708e5d5a36520b9">  824</a></span>&#160;  zipsmCPassDir  = 0x0001,  </div>
<div class="line"><a name="l00825"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fa6bf3035e3a5b79db2f25108c545b8f38">  825</a></span>&#160;  zipsmCPFile0  = 0x0002,  </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div>
<div class="line"><a name="l00830"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669faa3e9feeec5393fdeac3c78d2bb18770d">  830</a></span>&#160;  zipsmNotCompSmall = 0x0004,</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div>
<div class="line"><a name="l00841"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fac8091f3b3088e300ce6eb90ee0e79858">  841</a></span>&#160;  zipsmCheckForEff = 0x0008,</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div>
<div class="line"><a name="l00848"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fac565ef877f837250f6e6c72239e3e7e2">  848</a></span>&#160;  zipsmMemoryFlag  = 0x0010,</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div>
<div class="line"><a name="l00854"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fa1937c9053c208a1509601d1b83167e64">  854</a></span>&#160;  zipsmCheckForEffInMem = zipsmMemoryFlag | zipsmCheckForEff,</div>
<div class="line"><a name="l00855"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fabf5d35dc579ac5a993632af2eb3f70b4">  855</a></span>&#160;  zipsmSmartPass = zipsmCPassDir | zipsmCPFile0,   </div>
<div class="line"><a name="l00856"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669faa8bdb16f8e81b8bf967d67e0aff5a2a6">  856</a></span>&#160;  zipsmSmartAdd = zipsmNotCompSmall | zipsmCheckForEff, </div>
<div class="line"><a name="l00857"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fa54480b73a36e09e82defde88ab7a6a38">  857</a></span>&#160;  zipsmSafeSmart = zipsmSmartPass | zipsmNotCompSmall,    </div>
<div class="line"><a name="l00858"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fa942dfc422b0f66642e23b74b4fa8b31e">  858</a></span>&#160;  zipsmSmartest = zipsmSmartPass | zipsmSmartAdd,   </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div>
<div class="line"><a name="l00866"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fa7e8d3011ce6b197006df0e7b4450359e">  866</a></span>&#160;  zipsmIgnoreDirectories = 0x0020,</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  zipsmInternal01  = 0xf000   <span class="comment">// For the internal use only.</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; };</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; <span class="keywordtype">bool</span> AddNewFile(<a class="code" href="structCZipAddNewFileInfo.html">CZipAddNewFileInfo</a>&amp; info);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; <span class="keywordtype">bool</span> AddNewFile(LPCTSTR lpszFilePath, <span class="keywordtype">int</span> iComprLevel = -1, <span class="keywordtype">bool</span> bFullPath = <span class="keyword">true</span>,</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="keywordtype">int</span> iSmartLevel = zipsmSafeSmart, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBufSize = 65536);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; <span class="keywordtype">bool</span> AddNewFile(LPCTSTR lpszFilePath,</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        LPCTSTR lpszFileNameInZip,</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                             <span class="keywordtype">int</span> iComprLevel = -1,                             </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="keywordtype">int</span> iSmartLevel = zipsmSafeSmart,</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                             <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBufSize = 65536);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; <span class="keywordtype">bool</span> AddNewFile(CZipAbstractFile&amp; af,</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        LPCTSTR lpszFileNameInZip,</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                             <span class="keywordtype">int</span> iComprLevel = -1,                             </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="keywordtype">int</span> iSmartLevel = zipsmSafeSmart,</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                             <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBufSize = 65536);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; <span class="keywordtype">bool</span> AddNewFiles(LPCTSTR lpszPath,</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      <a class="code" href="classZipArchiveLib_1_1CFileFilter.html">ZipArchiveLib::CFileFilter</a>&amp; filter,</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <span class="keywordtype">bool</span> bRecursive = <span class="keyword">true</span>,</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      <span class="keywordtype">int</span> iComprLevel = -1,</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      <span class="keywordtype">bool</span> bSkipInitialPath = <span class="keyword">true</span>,</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      <span class="keywordtype">int</span> iSmartLevel = zipsmSafeSmart,</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBufSize = 65536);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div>
<div class="line"><a name="l01048"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a4edbda7e98bb8b51b98d0f413b062703"> 1048</a></span>&#160; <span class="keywordtype">bool</span> AddNewFiles(LPCTSTR lpszPath, </div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      LPCTSTR lpszFileMask = _T(<span class="stringliteral">&quot;*.*&quot;</span>), </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <span class="keywordtype">bool</span> bRecursive = <span class="keyword">true</span>, </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <span class="keywordtype">int</span> iComprLevel = -1, </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <span class="keywordtype">bool</span> bSkipInitialPath = <span class="keyword">true</span>, </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <span class="keywordtype">int</span> iSmartLevel = zipsmSafeSmart, </div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBufSize = 65536)</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <a class="code" href="classZipArchiveLib_1_1CNameFileFilter.html">ZipArchiveLib::CNameFileFilter</a> filter(lpszFileMask);</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <span class="keywordflow">return</span> AddNewFiles(lpszPath, filter, bRecursive, iComprLevel, </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;   bSkipInitialPath, iSmartLevel, nBufSize);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; }</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; <span class="keywordtype">bool</span> AddNewFiles(<a class="code" href="classCZipAddFilesEnumerator.html">CZipAddFilesEnumerator</a>&amp; addFilesEnumerator, <a class="code" href="classZipArchiveLib_1_1CFileFilter.html">ZipArchiveLib::CFileFilter</a>&amp; filter, <span class="keywordtype">bool</span> bSkipInitialPath = <span class="keyword">true</span> );</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div>
<div class="line"><a name="l01109"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a6a72dbdd7f9496ecbb9ad84979dbcb80"> 1109</a></span>&#160; ZIP_INDEX_TYPE GetLastIndexAdded()<span class="keyword"> const</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <span class="keywordflow">return</span> m_centralDir.GetLastIndexAdded();</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160; }</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;</div>
<div class="line"><a name="l01172"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a6065bf986f315928dd4945d3bec495cd"> 1172</a></span>&#160; <span class="keywordtype">bool</span> OpenNewFile(<a class="code" href="classCZipFileHeader.html">CZipFileHeader</a>&amp; header, <span class="keywordtype">int</span> iLevel = <a class="code" href="classCZipCompressor.html#a7fada8bbd7698360872cbc166f20cae7accc91672b5fe070b6151d98772399488" title="The default compression level (equals 6 for deflate).">CZipCompressor::levelDefault</a>, LPCTSTR lpszFilePath = NULL)</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160; {</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="keywordflow">return</span> OpenNewFile(header, iLevel, lpszFilePath, ZIP_FILE_INDEX_UNSPECIFIED);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160; }</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160; <span class="keywordtype">bool</span> WriteNewFile(<span class="keyword">const</span> <span class="keywordtype">void</span> *pBuf, DWORD uSize);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160; <span class="keywordtype">bool</span> CloseNewFile(<span class="keywordtype">bool</span> bAfterException = <span class="keyword">false</span>);</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div>
<div class="line"><a name="l01271"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a648b5aa0358a5b4e77affc3dbc1ede11"> 1271</a></span>&#160; <span class="keywordtype">bool</span> GetFromArchive(<a class="code" href="classCZipArchive.html" title="Represents a zip archive file. ">CZipArchive</a>&amp; zip, ZIP_INDEX_TYPE uIndex, LPCTSTR lpszNewFileName = NULL, ZIP_INDEX_TYPE uReplaceIndex = ZIP_FILE_INDEX_UNSPECIFIED, <span class="keywordtype">bool</span> bKeepSystComp = <span class="keyword">false</span>)</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160; {    </div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  InitBuffer();</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  <span class="keywordtype">bool</span> bRet;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  <span class="keywordflow">try</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  {</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;   bRet = GetFromArchive(zip, uIndex, lpszNewFileName, uReplaceIndex, bKeepSystComp, GetCallback(<a class="code" href="structCZipActionCallback.html#a987550875690c39c4278cc65e4f11734a3b1d7784f0f9cb69b22cee675b965f8c">CZipActionCallback::cbGet</a>));</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  }</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  <span class="keywordflow">catch</span>(...)</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;   ReleaseBuffer();</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;   <span class="keywordflow">throw</span>;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  }</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  ReleaseBuffer();</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <span class="keywordflow">if</span> (bRet)</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;   Finalize(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <span class="keywordflow">return</span> bRet;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160; }</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160; <span class="keywordtype">bool</span> GetFromArchive(<a class="code" href="classCZipArchive.html" title="Represents a zip archive file. ">CZipArchive</a>&amp; zip, CZipIndexesArray &amp;aIndexes, <span class="keywordtype">bool</span> bKeepSystComp = <span class="keyword">false</span>);</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160; </div>
<div class="line"><a name="l01387"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a089c9e3fa4d74ef21585b0b749b15ab5"> 1387</a></span>&#160; <span class="keywordtype">bool</span> GetFromArchive(<a class="code" href="classCZipArchive.html" title="Represents a zip archive file. ">CZipArchive</a>&amp; zip, CZipStringArray &amp;aNames, <span class="keywordtype">bool</span> bKeepSystComp = <span class="keyword">false</span>)</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160; {</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  CZipIndexesArray indexes;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  zip.<a class="code" href="classCZipArchive.html#a95573d33042d4adc73f36f4b1a7a0b3a">GetIndexes</a>(aNames, indexes);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  <span class="keywordflow">return</span> GetFromArchive(zip, indexes, bKeepSystComp);</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160; }</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160; <span class="keywordtype">void</span> GetIndexes(<span class="keyword">const</span> CZipStringArray &amp;aNames, CZipIndexesArray&amp; aIndexes);</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160; <span class="keywordtype">bool</span> ExtractFile(ZIP_INDEX_TYPE uIndex,</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  LPCTSTR lpszPath,</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  <span class="keywordtype">bool</span> bFullPath = <span class="keyword">true</span>,</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  LPCTSTR lpszNewName = NULL,</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  <a class="code" href="namespaceZipPlatform.html#ac9c4b2519743e730d7c1106e36172b2c">ZipPlatform::FileOverwriteMode</a> iOverwriteMode = <a class="code" href="namespaceZipPlatform.html#ac9c4b2519743e730d7c1106e36172b2caf99d3e080d0e4b646692500f172833e5" title="No special action is taken when overwriting a file.">ZipPlatform::fomRegular</a>,</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  DWORD nBufSize = 65536);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; </div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160; <span class="keywordtype">bool</span> ExtractFile(ZIP_INDEX_TYPE uIndex,</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  CZipAbstractFile&amp; af,</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <span class="keywordtype">bool</span> bRewind = <span class="keyword">true</span>,</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  DWORD nBufSize = 65536);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160; <span class="keywordtype">bool</span> <a class="code" href="namespaceZipPlatform.html#a3c1d17d400f71485ff45bba1a43aa411">OpenFile</a>(ZIP_INDEX_TYPE uIndex);</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160; DWORD ReadFile(<span class="keywordtype">void</span> *pBuf, DWORD uSize);</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160; <span class="keywordtype">int</span> CloseFile(LPCTSTR lpszFilePath = NULL, <span class="keywordtype">bool</span> bAfterException = <span class="keyword">false</span>);</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160; <span class="keywordtype">int</span> CloseFile(CZipFile &amp;file);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160; <span class="keywordtype">bool</span> TestFile(ZIP_INDEX_TYPE uIndex, DWORD uBufSize = 65536);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160; <span class="keywordtype">bool</span> <a class="code" href="namespaceZipPlatform.html#a31e7df142de0c01733db729331165458" title="Removes a file.">RemoveFile</a>(ZIP_INDEX_TYPE uIndex, <span class="keywordtype">bool</span> bRemoveData = <span class="keyword">true</span>);</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160; <span class="keywordtype">bool</span> RemoveFiles(CZipIndexesArray&amp; aIndexes);</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160; <span class="keywordtype">bool</span> RemoveFiles(<span class="keyword">const</span> CZipStringArray&amp; aNames);</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160; <span class="keywordtype">bool</span> ShiftData(ZIP_SIZE_TYPE uOffset);</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160; <span class="keywordtype">bool</span> PrependData(LPCTSTR lpszFilePath, LPCTSTR lpszNewExt = </div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;#ifdef _ZIP_SYSTEM_WIN</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  _T(<span class="stringliteral">&quot;exe&quot;</span>)</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;#<span class="keywordflow">else</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  _T(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;#endif</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  );</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160; <span class="keywordtype">bool</span> PrependData(CZipAbstractFile&amp; file, LPCTSTR lpszNewExt = NULL);</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160; <span class="keywordtype">bool</span> SetGlobalComment(LPCTSTR lpszComment, UINT codePage = ZIP_DEFAULT_CODE_PAGE);</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160; CZipString GetGlobalComment()<span class="keyword">const</span> ;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160; </div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160; CZipString GetArchivePath()<span class="keyword">const</span>;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160; ZIP_VOLUME_TYPE GetCurrentVolume() <span class="keyword">const</span> ;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160; </div>
<div class="line"><a name="l01878"></a><span class="lineno"><a class="code" href="classCZipArchive.html#af0a22d585f747e1f506491a59fef0445"> 1878</a></span>&#160; <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#af0a22d585f747e1f506491a59fef0445">FFCaseSens</a></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160; {</div>
<div class="line"><a name="l01886"></a><span class="lineno"><a class="code" href="classCZipArchive.html#af0a22d585f747e1f506491a59fef0445a444f27e5af71ea1123c74ebd81782484"> 1886</a></span>&#160;  <a class="code" href="classCZipArchive.html#af0a22d585f747e1f506491a59fef0445a444f27e5af71ea1123c74ebd81782484">ffDefault</a>,</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;</div>
<div class="line"><a name="l01894"></a><span class="lineno"><a class="code" href="classCZipArchive.html#af0a22d585f747e1f506491a59fef0445a04a52dbca5df0c96804960c1e1d724f0"> 1894</a></span>&#160;  <a class="code" href="classCZipArchive.html#af0a22d585f747e1f506491a59fef0445a04a52dbca5df0c96804960c1e1d724f0">ffCaseSens</a>,</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;</div>
<div class="line"><a name="l01902"></a><span class="lineno"><a class="code" href="classCZipArchive.html#af0a22d585f747e1f506491a59fef0445a7d8e3774e9edba7bcf4e4a646ef78d12"> 1902</a></span>&#160;  ffNoCaseSens</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160; };</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160; ZIP_INDEX_TYPE FindFile(LPCTSTR lpszFileName, <span class="keywordtype">int</span> iCaseSensitive = ffDefault, <span class="keywordtype">bool</span> bFileNameOnly = <span class="keyword">false</span>);</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160; <span class="keywordtype">bool</span> GetFileInfo(<a class="code" href="classCZipFileHeader.html">CZipFileHeader</a>&amp; fhInfo, ZIP_INDEX_TYPE uIndex) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160; <a class="code" href="classCZipFileHeader.html">CZipFileHeader</a>* GetFileInfo(ZIP_INDEX_TYPE uIndex);</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160; <span class="keyword">const</span> <a class="code" href="classCZipFileHeader.html">CZipFileHeader</a>* GetFileInfo(ZIP_INDEX_TYPE uIndex) <span class="keyword">const</span>;</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;</div>
<div class="line"><a name="l02040"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a51e1539faed798f0524cbfa7c47f5513"> 2040</a></span>&#160; <a class="code" href="classCZipFileHeader.html">CZipFileHeader</a>* operator[](ZIP_INDEX_TYPE uIndex)</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160; {</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  <span class="keywordflow">return</span> GetFileInfo(uIndex);</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160; }</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;</div>
<div class="line"><a name="l02068"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a131d33178f4663782c092666a99a89c5"> 2068</a></span>&#160; <span class="keyword">const</span> <a class="code" href="classCZipFileHeader.html">CZipFileHeader</a>* operator[](ZIP_INDEX_TYPE uIndex)<span class="keyword"> const</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  <span class="keywordflow">return</span> GetFileInfo(uIndex);</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160; }</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;</div>
<div class="line"><a name="l02086"></a><span class="lineno"><a class="code" href="classCZipArchive.html#ab3bdd0322dd12c40434cd8f0d9ad2523"> 2086</a></span>&#160; ZIP_INDEX_TYPE GetCount(<span class="keywordtype">bool</span> bOnlyFiles)</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160; {</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  <span class="keywordflow">if</span> (IsClosed())</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;   <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;  ZIP_INDEX_TYPE iTotalCount = GetCount();</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <span class="keywordflow">if</span> (bOnlyFiles)</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;  {</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;   ZIP_INDEX_TYPE iCount = 0;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;   <span class="keywordflow">for</span> (ZIP_INDEX_TYPE i = 0; i &lt; iTotalCount; i++)</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;   {</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    <span class="keywordflow">if</span> (!m_centralDir[i]-&gt;<a class="code" href="namespaceZipPlatform.html#a62a6f9cb5d789c22c3fc035a3260dbde">IsDirectory</a>())</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;     iCount++;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;   }</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;   <span class="keywordflow">return</span> iCount;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  }</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;   <span class="keywordflow">return</span> iTotalCount;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160; }</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;</div>
<div class="line"><a name="l02113"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a50fa2f64fc0150c7685fb1f52adf747f"> 2113</a></span>&#160; ZIP_INDEX_TYPE GetCount()<span class="keyword"> const</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  <span class="keywordflow">return</span> (ZIP_INDEX_TYPE) m_centralDir.GetCount();</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160; }</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;</div>
<div class="line"><a name="l02129"></a><span class="lineno"><a class="code" href="classCZipArchive.html#abc708f54f7523070c2043aed3e92e263"> 2129</a></span>&#160; ZIP_SIZE_TYPE GetOccupiedSpace()<span class="keyword"> const</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;  <span class="keywordflow">if</span> (IsClosed(<span class="keyword">true</span>) || IsClosed(<span class="keyword">false</span>))</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;  {</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;   ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : ZipArchive or the current volume file is closed.\n&quot;</span>);</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;   <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  }</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  <span class="keywordflow">return</span> m_storage.GetOccupiedSpace() + m_centralDir.GetSize(<span class="keyword">true</span>);</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160; }</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;</div>
<div class="line"><a name="l02142"></a><span class="lineno"><a class="code" href="classCZipArchive.html#aef1712a894641d675903b34c815de802"> 2142</a></span>&#160; <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#aef1712a894641d675903b34c815de802">CloseAfterException</a></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160; {</div>
<div class="line"><a name="l02147"></a><span class="lineno"><a class="code" href="classCZipArchive.html#aef1712a894641d675903b34c815de802ac1f4cb9f2ddacd20cc121c66504cb657"> 2147</a></span>&#160;  <a class="code" href="classCZipArchive.html#aef1712a894641d675903b34c815de802ac1f4cb9f2ddacd20cc121c66504cb657">afNoException</a>,</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;</div>
<div class="line"><a name="l02154"></a><span class="lineno"><a class="code" href="classCZipArchive.html#aef1712a894641d675903b34c815de802a64383ab2ba2586c69af5add1a1c6d665"> 2154</a></span>&#160;  <a class="code" href="classCZipArchive.html#aef1712a894641d675903b34c815de802a64383ab2ba2586c69af5add1a1c6d665">afAfterException</a>,</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;</div>
<div class="line"><a name="l02161"></a><span class="lineno"><a class="code" href="classCZipArchive.html#aef1712a894641d675903b34c815de802a037ed078fff70fca7148d375c2015677"> 2161</a></span>&#160;  afWriteDir</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160; };</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160; CZipString Close(<span class="keywordtype">int</span> iAfterException = afNoException, <span class="keywordtype">bool</span> bUpdateTimeStamp = <span class="keyword">false</span>);</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;</div>
<div class="line"><a name="l02202"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a60166588e0126c68899860e00676a51f"> 2202</a></span>&#160; <span class="keywordtype">bool</span> IsClosed(<span class="keywordtype">bool</span> bArchive = <span class="keyword">true</span>)<span class="keyword">const</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  <span class="keywordflow">return</span> m_storage.IsClosed(bArchive);</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160; }</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160; <span class="keywordtype">bool</span> Finalize(<span class="keywordtype">bool</span> bOnlyIfAuto = <span class="keyword">false</span>);</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;</div>
<div class="line"><a name="l02242"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a72e5c3c86552c535d764c3da4e8ce163"> 2242</a></span>&#160; <span class="keywordtype">void</span> FlushBuffers()</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160; {</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;  <span class="keywordflow">if</span> (IsClosed())</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;  {</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;   ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : ZipArchive should be opened first.\n&quot;</span>);</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;   <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;  }</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  m_storage.FlushBuffers();</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160; }</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160; <span class="keywordtype">bool</span> SetAutoFinalize(<span class="keywordtype">bool</span> bAutoFinalize = <span class="keyword">true</span>);</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160; </div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;</div>
<div class="line"><a name="l02287"></a><span class="lineno"><a class="code" href="classCZipArchive.html#afb30ad3cbaf8726630b2fa0933f91482"> 2287</a></span>&#160; <span class="keywordtype">bool</span> <a class="code" href="classCZipArchive.html#afb30ad3cbaf8726630b2fa0933f91482">GetAutoFinalize</a>()<span class="keyword">const </span>{<span class="keywordflow">return</span> m_bAutoFinalize;}</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160; <span class="keywordtype">bool</span> SetSystemCompatibility(<span class="keywordtype">int</span> iSystemComp);</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;</div>
<div class="line"><a name="l02335"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a5cd378df6bf6c5e119aed6f06bc921cc"> 2335</a></span>&#160; <span class="keywordtype">int</span> <a class="code" href="classCZipArchive.html#a5cd378df6bf6c5e119aed6f06bc921cc">GetSystemCompatibility</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_iArchiveSystCompatib;}</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;</div>
<div class="line"><a name="l02346"></a><span class="lineno"><a class="code" href="classCZipArchive.html#af2cb18a0c834f64284f6485b01df50a8"> 2346</a></span>&#160; <a class="code" href="classCZipStorage.html">CZipStorage</a>* <a class="code" href="classCZipArchive.html#af2cb18a0c834f64284f6485b01df50a8">GetStorage</a>(){<span class="keywordflow">return</span> &amp;m_storage;}</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;<span class="preprocessor">#ifdef _ZIP_UNICODE_CUSTOM</span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02366"></a><span class="lineno"><a class="code" href="classCZipArchive.html#ac497dc2ebb4b65be1f5b7d08fe024a29"> 2366</a></span>&#160; <span class="keywordtype">void</span> SetStringStoreSettings(<span class="keyword">const</span> <a class="code" href="classCZipStringStoreSettings.html">CZipStringStoreSettings</a>&amp; settings)</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160; {</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;  m_stringSettings = settings;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160; }</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;</div>
<div class="line"><a name="l02394"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a6eadc5f798ca0897e025c2d79771bbd4"> 2394</a></span>&#160; <span class="keywordtype">void</span> SetStringStoreSettings(UINT uFileNameCodePage, <span class="keywordtype">bool</span> bStoreNameInExtraData, UINT uCommentCodePage)</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160; {</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;  m_stringSettings.<a class="code" href="classCZipStringStoreSettings.html#ab6c7c033a9c051fd3cbe5427d521c657">Set</a>(uFileNameCodePage, bStoreNameInExtraData, uCommentCodePage);</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160; }</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;</div>
<div class="line"><a name="l02420"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a6a2d19de8bb5cc3939bc0d4dce1c1150"> 2420</a></span>&#160; <span class="keywordtype">void</span> SetStringStoreSettings(UINT uFileNameCodePage, <span class="keywordtype">bool</span> bStoreNameInExtraData = <span class="keyword">false</span>)</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160; {</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;  SetStringStoreSettings(uFileNameCodePage, bStoreNameInExtraData,  m_stringSettings.m_uCommentCodePage);</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160; }</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160; </div>
<div class="line"><a name="l02440"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a81a15f347bad84ffaeee0c8eff3b98db"> 2440</a></span>&#160; <span class="keywordtype">void</span> ResetStringStoreSettings()</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160; {</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;  m_stringSettings.Reset(m_iArchiveSystCompatib);</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160; }</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;</div>
<div class="line"><a name="l02464"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a54f26713f4bc6c808250fe5a0b8b0565"> 2464</a></span>&#160; <a class="code" href="classCZipStringStoreSettings.html">CZipStringStoreSettings</a>&amp; GetStringStoreSettings()</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160; {</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;  <span class="keywordflow">return</span> m_stringSettings;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160; }</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02476"></a><span class="lineno"><a class="code" href="classCZipArchive.html#ac5c98aebbf9defcb4b5e16683b51d80e"> 2476</a></span>&#160; <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#ac5c98aebbf9defcb4b5e16683b51d80e">UnicodeMode</a></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160; {</div>
<div class="line"><a name="l02478"></a><span class="lineno"><a class="code" href="classCZipArchive.html#ac5c98aebbf9defcb4b5e16683b51d80ea0069414c73e257bae21ffdc7970539d1"> 2478</a></span>&#160;  umNone  = 0x00, </div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="preprocessor">#ifdef _ZIP_UNICODE_CUSTOM</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"><a class="code" href="classCZipArchive.html#ac5c98aebbf9defcb4b5e16683b51d80eacf7f0e438c63ad9562aad7d2d990093c"> 2480</a></span>&#160;<span class="preprocessor"></span>  umCustom = 0x04 </div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;<span class="preprocessor"></span> };</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;</div>
<div class="line"><a name="l02493"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a56e17863ae02b8a6dc6c1149b71568a4"> 2493</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classCZipArchive.html#a56e17863ae02b8a6dc6c1149b71568a4">SetUnicodeMode</a>(<span class="keywordtype">int</span> iMode){ m_centralDir.SetUnicodeMode(iMode); }</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;</div>
<div class="line"><a name="l02504"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a25603e19d2c08a0399a7c2ea890bce6f"> 2504</a></span>&#160; <span class="keywordtype">int</span> <a class="code" href="classCZipArchive.html#a25603e19d2c08a0399a7c2ea890bce6f">GetUnicodeMode</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_centralDir.GetUnicodeMode(); }</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160; <span class="keywordtype">void</span> EnableFindFast(<span class="keywordtype">bool</span> bEnable = <span class="keyword">true</span>);</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;</div>
<div class="line"><a name="l02539"></a><span class="lineno"><a class="code" href="classCZipArchive.html#ad5f980abfefe3f4e075da12623d13274"> 2539</a></span>&#160; ZIP_INDEX_TYPE GetFindFastIndex(ZIP_INDEX_TYPE iFindFastIndex)<span class="keyword"> const</span></div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;  <span class="keywordflow">if</span> (IsClosed())</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;  {</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;   ZIPTRACE(<span class="stringliteral">&quot;CZipArchive::GetFindFastIndex: ZipArchive should be opened first.\n&quot;</span>);</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;   <span class="keywordflow">return</span> ZIP_FILE_INDEX_UNSPECIFIED;</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;  }</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;  </div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;  <span class="keywordflow">return</span> m_centralDir.GetFindFastIndex(iFindFastIndex);</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160; }</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160; <span class="keywordtype">void</span> SetTempPath(LPCTSTR lpszPath = NULL, <span class="keywordtype">bool</span> bForce = <span class="keyword">true</span>);</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;</div>
<div class="line"><a name="l02589"></a><span class="lineno"><a class="code" href="classCZipArchive.html#aaeeed7da4af0194d9792e4fd2b25dd5f"> 2589</a></span>&#160; CZipString GetTempPath()<span class="keyword">const </span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;  <span class="keywordflow">return</span> m_szTempPath;</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160; }</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;</div>
<div class="line"><a name="l02597"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a567d568ba3e724cd41d15db4e7aa724f"> 2597</a></span>&#160; <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#a567d568ba3e724cd41d15db4e7aa724f">Predict</a></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160; {</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160; </div>
<div class="line"><a name="l02600"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a567d568ba3e724cd41d15db4e7aa724fafc6c23f7a1c59e62127bb244a693e28a"> 2600</a></span>&#160;  <a class="code" href="classCZipArchive.html#a567d568ba3e724cd41d15db4e7aa724fafc6c23f7a1c59e62127bb244a693e28a" title="If lpszFilePath is a directory, appends a separator.">prDir</a>,  </div>
<div class="line"><a name="l02601"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a567d568ba3e724cd41d15db4e7aa724fa551c4f6dbe8566f9702de2d4f3cb0eb4"> 2601</a></span>&#160;  <a class="code" href="classCZipArchive.html#a567d568ba3e724cd41d15db4e7aa724fa551c4f6dbe8566f9702de2d4f3cb0eb4" title="Treats lpszFilePath as a common file.">prFile</a>, </div>
<div class="line"><a name="l02602"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a567d568ba3e724cd41d15db4e7aa724fa36adfe21a31a4f045b9ebfe265e2f017"> 2602</a></span>&#160;  prAuto  </div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160; };</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160; CZipString PredictFileNameInZip(LPCTSTR lpszFilePath, <span class="keywordtype">bool</span> bFullPath, <span class="keywordtype">int</span> iWhat = prAuto) <span class="keyword">const</span> ;</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160; ZIP_SIZE_TYPE PredictMaximumFileSizeInArchive(<a class="code" href="classCZipFileHeader.html">CZipFileHeader</a>&amp; fh);</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160; ZIP_SIZE_TYPE PredictMaximumFileSizeInArchive(LPCTSTR lpszFilePath, <span class="keywordtype">bool</span> bFullPath);</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160; </div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160; ZIP_INDEX_TYPE WillBeDuplicated(LPCTSTR lpszFilePath, <span class="keywordtype">bool</span> bFullPath, <span class="keywordtype">bool</span> bFileNameOnly = <span class="keyword">false</span>, <span class="keywordtype">int</span> iWhat = prAuto);</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160; CZipString PredictExtractedFileName(LPCTSTR lpszFileNameInZip, LPCTSTR lpszPath, <span class="keywordtype">bool</span> bFullPath, LPCTSTR lpszNewName = NULL)<span class="keyword">const</span> ;</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160; CZipString TrimRootPath(<a class="code" href="classCZipPathComponent.html">CZipPathComponent</a>&amp; zpc) <span class="keyword">const</span> ;</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160; <span class="keyword">static</span> <span class="keywordtype">bool</span> RemovePathBeginning(LPCTSTR lpszBeginning, CZipString&amp; szPath, ZIPSTRINGCOMPARE pCompareFunction);</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;</div>
<div class="line"><a name="l02770"></a><span class="lineno"><a class="code" href="classCZipArchive.html#aec981beb4dfb55e4a2f054c410ee3031"> 2770</a></span>&#160; <span class="keywordtype">void</span> SetCaseSensitivity(<span class="keywordtype">bool</span> bCaseSensitive) </div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160; {</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;  m_bCaseSensitive = bCaseSensitive;</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;  m_pZipCompare = GetCZipStrCompFunc(bCaseSensitive);</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160; }</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;</div>
<div class="line"><a name="l02785"></a><span class="lineno"><a class="code" href="classCZipArchive.html#ac9f41cec9406c2eee3c6064ea060f340"> 2785</a></span>&#160; <span class="keywordtype">bool</span> GetCaseSensitivity()<span class="keyword"> const</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;  <span class="keywordflow">return</span> m_bCaseSensitive;</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160; }</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160; <span class="keywordtype">void</span> GetCentralDirInfo(<a class="code" href="structCZipCentralDir_1_1CInfo.html">CZipCentralDir::CInfo</a>&amp; info)<span class="keyword">const</span>;</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160; </div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;</div>
<div class="line"><a name="l02813"></a><span class="lineno"><a class="code" href="classCZipArchive.html#ae67accf5d79f14ffc57ec17833dc7623"> 2813</a></span>&#160; ZIP_SIZE_TYPE GetCentralDirSize(<span class="keywordtype">bool</span> bWhole = <span class="keyword">true</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;  <span class="keywordflow">if</span> (IsClosed())</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;  {</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;   ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : ZipArchive is closed.\n&quot;</span>);</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;   <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;  }</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;  <span class="keywordflow">return</span> m_centralDir.GetSize(bWhole);</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160; }</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;</div>
<div class="line"><a name="l02831"></a><span class="lineno"><a class="code" href="classCZipArchive.html#ac50bc9678b14ae075d2c252f0b38bd0d"> 2831</a></span>&#160; <span class="keywordtype">bool</span> <a class="code" href="classCZipArchive.html#ac50bc9678b14ae075d2c252f0b38bd0d">IsReadOnly</a>(){<span class="keywordflow">return</span> m_storage.IsReadOnly();} <span class="keyword">const</span></div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;</div>
<div class="line"><a name="l02844"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a8507cdbe74b6698a74f247c1c8bdbab8"> 2844</a></span>&#160; <span class="keywordtype">void</span> SetBytesBeforeZip(ZIP_SIZE_TYPE uCount = 0)</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160; {</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;  <span class="keywordflow">if</span> (!IsClosed())</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;  {</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;   ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : Set it before opening the archive.\n&quot;</span>);</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;   <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;  }</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;  m_storage.m_uBytesBeforeZip = uCount;</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160; }</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;</div>
<div class="line"><a name="l02862"></a><span class="lineno"><a class="code" href="classCZipArchive.html#aca3e489f54afcd72390093e853af822e"> 2862</a></span>&#160; ZIP_SIZE_TYPE GetBytesBeforeZip()<span class="keyword"> const</span></div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;  <span class="keywordflow">return</span> m_storage.m_uBytesBeforeZip;</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160; }</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;</div>
<div class="line"><a name="l02871"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4d"> 2871</a></span>&#160; <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4d">ConsistencyCheck</a></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160; {  </div>
<div class="line"><a name="l02873"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4da611deca107b7fc16b2e255972e3ff999"> 2873</a></span>&#160;  <a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4da611deca107b7fc16b2e255972e3ff999" title="If used in the SetIgnoredConsistencyChecks method, examines all possible inconsistencies in an archiv...">checkNone</a>,       </div>
<div class="line"><a name="l02874"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4dafee0cd5bb67d85fe0256fabfc3b8d8d6"> 2874</a></span>&#160;  checkCRC    = 0x0001, </div>
<div class="line"><a name="l02875"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4dae9a0cddb18592358dbd152fbec81f000"> 2875</a></span>&#160;  checkLocalMethod  = 0x0002, </div>
<div class="line"><a name="l02876"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4dad3cd972f4b468d9c7136e5ca4517c745"> 2876</a></span>&#160;  checkLocalSizes   = 0x0004, </div>
<div class="line"><a name="l02877"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4daf524b056991ec9941b55c5c49e3794c2"> 2877</a></span>&#160;  checkLocalCRC   = 0x0008, </div>
<div class="line"><a name="l02878"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4dadf236f7324db99316807e1fce3b78327"> 2878</a></span>&#160;  checkLocalFlag   = 0x0010, </div>
<div class="line"><a name="l02879"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4da444c069eb1e6f70192ff7b595d2db0a1"> 2879</a></span>&#160;  checkLocalAll   = checkLocalMethod | checkLocalSizes | checkLocalCRC | checkLocalFlag, </div>
<div class="line"><a name="l02880"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4daff3c8c747216fe654286edcd57f55230"> 2880</a></span>&#160;  checkDataDescriptor  = 0x0100, </div>
<div class="line"><a name="l02881"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4daca249fea9a22c531bd4b69a277097f33"> 2881</a></span>&#160;  checkVolumeEntries  = 0x0200, </div>
<div class="line"><a name="l02882"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4da7ecd57be82b9d2a43d0ef3d720f8fca8"> 2882</a></span>&#160;  checkDecryptionVerifier = 0x0400, </div>
<div class="line"><a name="l02883"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4da9263f24723fdc0985f274d84ee54b6f7"> 2883</a></span>&#160;  checkAll    = checkCRC | checkLocalAll | checkDataDescriptor | checkVolumeEntries | checkDecryptionVerifier, </div>
<div class="line"><a name="l02884"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a23977e24b0930a40a83c0e4075860e4dabc39679fb833080779440a4a4b88d93f"> 2884</a></span>&#160;  checkIgnoredByDefault = checkDataDescriptor | checkVolumeEntries </div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160; };</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;</div>
<div class="line"><a name="l02893"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a97ab2d09b10ab2f1ae446560a4f44561"> 2893</a></span>&#160; <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#a97ab2d09b10ab2f1ae446560a4f44561">SpecialFlags</a></div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160; {</div>
<div class="line"><a name="l02898"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a97ab2d09b10ab2f1ae446560a4f44561af45335ffe5533e1caa5107735ddd7a45"> 2898</a></span>&#160;  <a class="code" href="classCZipArchive.html#a97ab2d09b10ab2f1ae446560a4f44561af45335ffe5533e1caa5107735ddd7a45">sfNone</a>,</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;</div>
<div class="line"><a name="l02908"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a97ab2d09b10ab2f1ae446560a4f44561a1c6105efbaf985ec970d338502f020cb"> 2908</a></span>&#160;  <a class="code" href="classCZipArchive.html#a97ab2d09b10ab2f1ae446560a4f44561a1c6105efbaf985ec970d338502f020cb">sfExhaustiveRead</a>,</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160; };</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;</div>
<div class="line"><a name="l02924"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a6c97370520628da3908d7dca9b58fdeb"> 2924</a></span>&#160; <span class="keywordtype">void</span> SetIgnoredConsistencyChecks(<span class="keywordtype">int</span> iLevel = checkIgnoredByDefault)</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160; {</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;  <span class="keywordflow">if</span> (IsClosed())</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;  {</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;   ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : Set it after opening the archive.\n&quot;</span>);</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;   <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;  }</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;  m_centralDir.m_iIgnoredChecks = iLevel;</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160; }</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160; </div>
<div class="line"><a name="l02940"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a69d2178514e8d8e0a4f91b6bb1e5864e"> 2940</a></span>&#160; <span class="keywordtype">int</span> GetIgnoredConsistencyChecks()<span class="keyword"> const</span></div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;  <span class="keywordflow">return</span> m_centralDir.m_iIgnoredChecks;</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160; }</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;</div>
<div class="line"><a name="l02951"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a996973569d480fba3627607dc7552db7"> 2951</a></span>&#160; <span class="keywordtype">void</span> SetSpecialFlags(<span class="keywordtype">int</span> iSpecialFlags)</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160; {</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;  <span class="keywordflow">if</span> (!IsClosed())</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;  {</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;   ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : Set it before opening the archive.\n&quot;</span>);</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;   <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;  }</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;  m_centralDir.m_specialFlags = iSpecialFlags;</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160; }</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;</div>
<div class="line"><a name="l02967"></a><span class="lineno"><a class="code" href="classCZipArchive.html#ada64e986cf98b13789acc996af7d3a90"> 2967</a></span>&#160; <span class="keywordtype">int</span> GetSpecialFlags()<span class="keyword"> const</span></div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;  <span class="keywordflow">return</span> m_centralDir.m_specialFlags;</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160; }</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160; <span class="keywordtype">void</span> FindMatches(LPCTSTR lpszPattern, CZipIndexesArray&amp; ar, <span class="keywordtype">bool</span> bFullPath = <span class="keyword">true</span>);</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160; </div>
<div class="line"><a name="l03006"></a><span class="lineno"><a class="code" href="classCZipArchive.html#aec499339bf3f20e7a198289b4288d7a4"> 3006</a></span>&#160; <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#aec499339bf3f20e7a198289b4288d7a4">CommitMode</a></div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160; {</div>
<div class="line"><a name="l03008"></a><span class="lineno"><a class="code" href="classCZipArchive.html#aec499339bf3f20e7a198289b4288d7a4a1fc91e619248861ee0b182ed90bea791"> 3008</a></span>&#160;  <a class="code" href="classCZipArchive.html#aec499339bf3f20e7a198289b4288d7a4a1fc91e619248861ee0b182ed90bea791" title="Changes will be committed when the CommitChanges method is called or when closing the archive...">cmManual</a>, </div>
<div class="line"><a name="l03009"></a><span class="lineno"><a class="code" href="classCZipArchive.html#aec499339bf3f20e7a198289b4288d7a4abb999d299acb20bd6995524b2c134be3"> 3009</a></span>&#160;  cmOnChange </div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160; };</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;</div>
<div class="line"><a name="l03025"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a28f18c652496e2599bd49d0f0648769d"> 3025</a></span>&#160; <span class="keywordtype">void</span> SetCommitMode(<span class="keywordtype">int</span> iCommitMode = cmOnChange) </div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160; { </div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;  m_iCommitMode = iCommitMode;</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160; }</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;</div>
<div class="line"><a name="l03043"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a3adb7bec41b0cfb44871c297a85c592e"> 3043</a></span>&#160; <span class="keywordtype">int</span> <a class="code" href="classCZipArchive.html#a3adb7bec41b0cfb44871c297a85c592e">GetCommitMode</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_iCommitMode;}</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160; <span class="keywordtype">bool</span> CommitChanges();</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;</div>
<div class="line"><a name="l03079"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a871adedb7077a464d52a2ab6ef36b4b7"> 3079</a></span>&#160; <span class="keywordtype">bool</span> <a class="code" href="classCZipArchive.html#a871adedb7077a464d52a2ab6ef36b4b7">IsModified</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> m_centralDir.IsAnyFileModified();}</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160; </div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160; <span class="keywordtype">bool</span> RemoveCentralDirectoryFromArchive();</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160; <span class="keywordtype">bool</span> ReadLocalHeader(ZIP_INDEX_TYPE uIndex);</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160; <span class="keywordtype">bool</span> OverwriteLocalHeader(ZIP_INDEX_TYPE uIndex);</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;</div>
<div class="line"><a name="l03134"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a53b9a02f389496fc4707a39036fc560a"> 3134</a></span>&#160; <span class="keyword">const</span> <a class="code" href="classCZipCompressor.html">CZipCompressor</a>* GetCurrentCompressor()<span class="keyword"> const</span></div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;  <span class="keywordflow">return</span> m_pCompressor;</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160; }</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;</div>
<div class="line"><a name="l03151"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a7bc5e2fdbda00dc96e237423e855af19"> 3151</a></span>&#160; <span class="keywordtype">bool</span> CanModify(<span class="keywordtype">bool</span> bAllowNewSegmented = <span class="keyword">false</span>, <span class="keywordtype">bool</span> bNeedsClosed = <span class="keyword">true</span>)</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160; {</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;  <span class="keywordflow">if</span> (IsClosed())</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;  {</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;   ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : ZipArchive is closed.\n&quot;</span>);</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;  }</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;  <span class="keywordflow">if</span> (m_storage.IsReadOnly())</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;  {</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;  }</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;  </div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;  <span class="keywordflow">if</span> (m_storage.IsNewSegmented() &amp;&amp; !bAllowNewSegmented)</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;  {</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;  }</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;  </div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;  <span class="keywordflow">if</span> (bNeedsClosed &amp;&amp; m_iFileOpened)</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;  {</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;   ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : The file cannot be open during modifications.\n&quot;</span>);</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;  }</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160; }</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;</div>
<div class="line"><a name="l03185"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a0851e67546ddd32b6d1a3b14a539118d"> 3185</a></span>&#160; <span class="keywordtype">bool</span> IsPasswordSet()<span class="keyword"> const</span></div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;  <span class="keywordflow">return</span> m_pszPassword.GetSize() &gt; 0;</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160; }</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;</div>
<div class="line"><a name="l03201"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a94caa0e293f0e2d767e4e0fa73c44459"> 3201</a></span>&#160; <span class="keywordtype">bool</span> IsFullFileTimes()<span class="keyword"> const</span></div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;<span class="keyword"> </span>{</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;  <span class="keywordflow">return</span> m_bStoreFullFileTimes;</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160; }</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;</div>
<div class="line"><a name="l03214"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a8c1f4603af771c4e3688a02d14e97c93"> 3214</a></span>&#160; <span class="keywordtype">void</span> SetFullFileTimes(<span class="keywordtype">bool</span> bFullFileTimes = <span class="keyword">true</span>)</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160; {</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;  <span class="keywordflow">if</span> (IsClosed())</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;  {</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;   ZIPTRACE(<span class="stringliteral">&quot;%s(%i) : Set it after opening the archive.\n&quot;</span>);</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;   <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;  }</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;  m_bStoreFullFileTimes = bFullFileTimes;</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160; }</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160; </div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160; <span class="keywordtype">bool</span> ResetCurrentVolume();</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160; <span class="keyword">static</span> <span class="keywordtype">bool</span> IsZipArchive(LPCTSTR lpszPathName);</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160; <span class="keyword">static</span> <span class="keywordtype">bool</span> IsZipArchive(CZipAbstractFile&amp; af, <span class="keywordtype">bool</span> bAutoClose = <span class="keyword">false</span>);</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;</div>
<div class="line"><a name="l03274"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a940810c83896365f88e4be14809674c9"> 3274</a></span>&#160; <span class="keywordtype">bool</span> <a class="code" href="classCZipArchive.html#a940810c83896365f88e4be14809674c9">m_bRemoveDriveLetter</a>;</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160; </div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160; </div>
<div class="line"><a name="l03285"></a><span class="lineno"><a class="code" href="classCZipArchive.html#ac93ea693b6cba8ceb429b73d3fad2ff5"> 3285</a></span>&#160; <span class="keywordtype">void</span> ReadLocalHeaderInternal(ZIP_INDEX_TYPE uIndex)</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160; {</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;  <span class="comment">// update sizes of the local filename and the extra field - they may differ from the ones in the central directory</span></div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;  GetFileInfo(uIndex)-&gt;ReadLocal(&amp;m_centralDir);</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160; }</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160; <span class="keywordtype">bool</span> EncryptFilesInternal(CZipIndexesArray* pIndexes);</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160; <span class="keywordtype">bool</span> OpenNewFile(<a class="code" href="classCZipFileHeader.html">CZipFileHeader</a> &amp; header, <span class="keywordtype">int</span> iLevel, LPCTSTR lpszFilePath, ZIP_INDEX_TYPE uReplaceIndex);</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160; </div>
<div class="line"><a name="l03322"></a><span class="lineno"><a class="code" href="classCZipArchive.html#aa795b1019332361e82b4f09d4c09f4a4"> 3322</a></span>&#160; ZipArchiveLib::CZipCallbackProvider <a class="code" href="classCZipArchive.html#aa795b1019332361e82b4f09d4c09f4a4">m_callbacks</a>;</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160; </div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160; <span class="keywordtype">void</span> WriteCentralDirectory(<span class="keywordtype">bool</span> bFlush = <span class="keyword">true</span>);</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;</div>
<div class="line"><a name="l03333"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a63c15f0ac2da695bbf5b2abaaa1c63b9"> 3333</a></span>&#160; <span class="keywordtype">bool</span> <a class="code" href="classCZipArchive.html#a63c15f0ac2da695bbf5b2abaaa1c63b9">m_bCaseSensitive</a>;</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;</div>
<div class="line"><a name="l03338"></a><span class="lineno"><a class="code" href="classCZipArchive.html#af86ab88d6e910743b14a5f4d01af55e7"> 3338</a></span>&#160; <span class="keywordtype">bool</span> <a class="code" href="classCZipArchive.html#af86ab88d6e910743b14a5f4d01af55e7">m_bStoreFullFileTimes</a>;</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160; </div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;</div>
<div class="line"><a name="l03345"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a583ac1a566a2d990a633ed667da1c143"> 3345</a></span>&#160; ZIPSTRINGCOMPARE <a class="code" href="classCZipArchive.html#a583ac1a566a2d990a633ed667da1c143">m_pZipCompare</a>;</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;</div>
<div class="line"><a name="l03353"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a54baf3557f580c2db1577a3c3da98a2b"> 3353</a></span>&#160; <a class="code" href="classCZipStorage.html">CZipStorage</a> <a class="code" href="classCZipArchive.html#a54baf3557f580c2db1577a3c3da98a2b">m_storage</a>;</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;</div>
<div class="line"><a name="l03360"></a><span class="lineno"><a class="code" href="classCZipArchive.html#aee3ada39e4ec242778b433cfd887278e"> 3360</a></span>&#160; <a class="code" href="classCZipCentralDir.html">CZipCentralDir</a> <a class="code" href="classCZipArchive.html#aee3ada39e4ec242778b433cfd887278e">m_centralDir</a>;</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;</div>
<div class="line"><a name="l03365"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a50a0edbfe33ae586c7a119c93b326671"> 3365</a></span>&#160; <span class="keyword">enum</span> <a class="code" href="classCZipArchive.html#a50a0edbfe33ae586c7a119c93b326671">OpenFileType</a></div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160; {</div>
<div class="line"><a name="l03367"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a50a0edbfe33ae586c7a119c93b326671ad22f504670df3b8e7ceb8f7a37917378"> 3367</a></span>&#160;  extract = -1, </div>
<div class="line"><a name="l03368"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a50a0edbfe33ae586c7a119c93b326671af4d8c9f91c22e297b77896ebdc52b239"> 3368</a></span>&#160;  <a class="code" href="classCZipArchive.html#a50a0edbfe33ae586c7a119c93b326671af4d8c9f91c22e297b77896ebdc52b239" title="There is no file inside the archive opened.">nothing</a>,  </div>
<div class="line"><a name="l03369"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a50a0edbfe33ae586c7a119c93b326671a99445f88722247f1f8cbb185572a3542"> 3369</a></span>&#160;  compress  </div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160; };</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160; </div>
<div class="line"><a name="l03375"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a798fcb7bc9984133999dbd1c6e6823e5"> 3375</a></span>&#160; <span class="keywordtype">int</span> <a class="code" href="classCZipArchive.html#a798fcb7bc9984133999dbd1c6e6823e5">m_iFileOpened</a>;</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;</div>
<div class="line"><a name="l03380"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a53e452ea83aa5d8d611062880b57ba5a"> 3380</a></span>&#160; <span class="keywordtype">bool</span> <a class="code" href="classCZipArchive.html#a53e452ea83aa5d8d611062880b57ba5a">m_bAutoFinalize</a>;</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;</div>
<div class="line"><a name="l03385"></a><span class="lineno"><a class="code" href="classCZipArchive.html#aa97444697499eb2c956744a7ac16f9e7"> 3385</a></span>&#160; <span class="keywordtype">int</span> <a class="code" href="classCZipArchive.html#aa97444697499eb2c956744a7ac16f9e7">m_iCommitMode</a>;</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;</div>
<div class="line"><a name="l03390"></a><span class="lineno"><a class="code" href="classCZipArchive.html#aa1895d5447111f55159aed88fa1f1d4d"> 3390</a></span>&#160; CZipString <a class="code" href="classCZipArchive.html#aa1895d5447111f55159aed88fa1f1d4d">m_szRootPath</a>;</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;</div>
<div class="line"><a name="l03395"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a0fe6e4697b6a9e7e6f52011c66621936"> 3395</a></span>&#160; CZipString <a class="code" href="classCZipArchive.html#a0fe6e4697b6a9e7e6f52011c66621936">m_szTempPath</a>;</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160; <span class="keywordtype">void</span> OpenInternal(<span class="keywordtype">int</span> iMode);</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160; <span class="keywordtype">void</span> InitOnOpen(<span class="keywordtype">int</span> iArchiveSystCompatib, <a class="code" href="classCZipCentralDir.html">CZipCentralDir</a>* pSource = NULL);</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;</div>
<div class="line"><a name="l03421"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a23a52208759f43b1efe57af59264a407"> 3421</a></span>&#160; <span class="keywordtype">int</span> <a class="code" href="classCZipArchive.html#a23a52208759f43b1efe57af59264a407">m_iArchiveSystCompatib</a>;</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;</div>
<div class="line"><a name="l03426"></a><span class="lineno"><a class="code" href="classCZipArchive.html#afd1df17f464a949ea40859bae5689e4a"> 3426</a></span>&#160; CZipAutoBuffer <a class="code" href="classCZipArchive.html#afd1df17f464a949ea40859bae5689e4a">m_pszPassword</a>;</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160; <a class="code" href="classCZipFileHeader.html">CZipFileHeader</a>* CurrentFile();</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;</div>
<div class="line"><a name="l03438"></a><span class="lineno"><a class="code" href="classCZipArchive.html#ae8d24271cb186f4db02064d82c9f6655"> 3438</a></span>&#160; <span class="keywordtype">void</span> ClearCryptograph()</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160; {</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;  <span class="keywordflow">if</span> (m_pCryptograph)</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;  {</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;   <span class="keyword">delete</span> m_pCryptograph;</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;   m_pCryptograph = NULL;</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;  }</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160; }</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;</div>
<div class="line"><a name="l03456"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a008c35d0a4f148b88c5d2177ebab46ec"> 3456</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> CreateCryptograph(<span class="keywordtype">int</span> iEncryptionMethod)</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160; {</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;  <span class="keywordflow">if</span> (m_pCryptograph != NULL)</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;   <span class="keywordflow">if</span> (m_pCryptograph-&gt;CanHandle(iEncryptionMethod))</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;  ClearCryptograph();</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;  m_pCryptograph = <a class="code" href="classCZipCryptograph.html#a67ea47605ae88bc06e0a07837505459e">CZipCryptograph::CreateCryptograph</a>(iEncryptionMethod);</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160; }</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;</div>
<div class="line"><a name="l03469"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a8650f1fa6f5eb19665d451921b27abca"> 3469</a></span>&#160; <a class="code" href="classCZipCryptograph.html">CZipCryptograph</a>* <a class="code" href="classCZipArchive.html#a8650f1fa6f5eb19665d451921b27abca">m_pCryptograph</a>;</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;</div>
<div class="line"><a name="l03474"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a9054cd040e9a2915898b291f68728c4e"> 3474</a></span>&#160; <span class="keywordtype">void</span> ClearCompressor()</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160; {</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;  <span class="keywordflow">if</span> (m_pCompressor)</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;  {</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;   <span class="keyword">delete</span> m_pCompressor;</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;   m_pCompressor = NULL;</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;  }</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160; }</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;</div>
<div class="line"><a name="l03492"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a5cf921a705ed1f79304880ba7c375660"> 3492</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> CreateCompressor(WORD uMethod)</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160; {</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;  <span class="keywordflow">if</span> (m_pCompressor == NULL || !m_pCompressor-&gt;CanProcess(uMethod))</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;  {</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;   ClearCompressor();</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;   m_pCompressor = <a class="code" href="classCZipCompressor.html#adb9fc500cbf2e53fba533e615d8e9b29">CZipCompressor::CreateCompressor</a>(uMethod, &amp;m_storage);</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;  }</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;  m_pCompressor-&gt;UpdateOptions(m_compressorsOptions);</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160; }</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;</div>
<div class="line"><a name="l03505"></a><span class="lineno"><a class="code" href="classCZipArchive.html#acb4fdfe54136a786dcf46c225bcdc93d"> 3505</a></span>&#160; <a class="code" href="classCZipCompressor.html">CZipCompressor</a>* <a class="code" href="classCZipArchive.html#acb4fdfe54136a786dcf46c225bcdc93d">m_pCompressor</a>;</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;</div>
<div class="line"><a name="l03510"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a4982e7da972267e0cd5db1e5b41094eb"> 3510</a></span>&#160; <span class="keywordtype">int</span> <a class="code" href="classCZipArchive.html#a4982e7da972267e0cd5db1e5b41094eb">m_iEncryptionMethod</a>;</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;</div>
<div class="line"><a name="l03515"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a135fd4a99a8befe6e7f38301e35e83a9"> 3515</a></span>&#160; WORD <a class="code" href="classCZipArchive.html#a135fd4a99a8befe6e7f38301e35e83a9">m_uCompressionMethod</a>;</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160; </div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;</div>
<div class="line"><a name="l03526"></a><span class="lineno"><a class="code" href="classCZipArchive.html#a2c10424365afc7d073e53bc1e120c410"> 3526</a></span>&#160; CZipAutoBuffer <a class="code" href="classCZipArchive.html#a2c10424365afc7d073e53bc1e120c410">m_pBuffer</a>;</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;</div>
<div class="line"><a name="l03536"></a><span class="lineno"><a class="code" href="classCZipArchive.html#aeb1fe32b8b4218244c88f0eb0d52688e"> 3536</a></span>&#160; DWORD <a class="code" href="classCZipArchive.html#aeb1fe32b8b4218244c88f0eb0d52688e">m_iBufferSize</a>;</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;<span class="preprocessor">#ifdef _ZIP_UNICODE_CUSTOM</span></div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03542"></a><span class="lineno"><a class="code" href="classCZipArchive.html#ad0613d8a6210b68a6569b45140a2e9a6"> 3542</a></span>&#160; <a class="code" href="classCZipStringStoreSettings.html">CZipStringStoreSettings</a> <a class="code" href="classCZipArchive.html#ad0613d8a6210b68a6569b45140a2e9a6">m_stringSettings</a>;</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160; <a class="code" href="classCZipCompressor_1_1COptionsMap.html">CZipCompressor::COptionsMap</a> m_compressorsOptions;</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160; <span class="keywordtype">void</span> Initialize();</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160; <span class="keywordtype">void</span> MakeSpaceForReplace(ZIP_INDEX_TYPE iReplaceIndex, ZIP_SIZE_TYPE uTotal, LPCTSTR lpszFileName);</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160; <span class="keywordtype">void</span> MovePackedFiles(ZIP_SIZE_TYPE uStartOffset, ZIP_SIZE_TYPE uEndOffset, ZIP_SIZE_TYPE uMoveBy, <a class="code" href="structCZipActionCallback.html">CZipActionCallback</a>* pCallback, <span class="keywordtype">bool</span> bForward = <span class="keyword">false</span>, <span class="keywordtype">bool</span> bLastCall = <span class="keyword">true</span>);</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160; </div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160; <span class="keywordtype">bool</span> RemoveLast(<span class="keywordtype">bool</span> bRemoveAnyway = <span class="keyword">false</span>);</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160; <span class="keywordtype">bool</span> GetFromArchive(<a class="code" href="classCZipArchive.html" title="Represents a zip archive file. ">CZipArchive</a>&amp; zip, ZIP_INDEX_TYPE uIndex, LPCTSTR lpszNewFileName, ZIP_INDEX_TYPE iReplaceIndex, <span class="keywordtype">bool</span> bKeepSystComp, <a class="code" href="structCZipActionCallback.html">CZipActionCallback</a>* pCallback);</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160; <span class="keywordtype">bool</span> UpdateReplaceIndex(ZIP_INDEX_TYPE&amp; iReplaceIndex);</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160; </div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160; <span class="keywordtype">void</span> ThrowError(<span class="keywordtype">int</span> err, LPCTSTR lpszFilePath = NULL) <span class="keyword">const</span>;  </div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160; <span class="keywordtype">void</span> InitBuffer()</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160; {</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;  m_pBuffer.Allocate(m_iBufferSize);</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160; }</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160; <span class="keywordtype">void</span> ReleaseBuffer()</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160; {</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;  m_pBuffer.Release();</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160; }</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;};</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;</div>
<div class="line"><a name="l03577"></a><span class="lineno"><a class="code" href="classCZipAddFilesEnumerator.html"> 3577</a></span>&#160;<span class="keyword">class </span>ZIP_API <a class="code" href="classCZipAddFilesEnumerator.html">CZipAddFilesEnumerator</a> : <span class="keyword">public</span> <a class="code" href="classZipArchiveLib_1_1CDirEnumerator.html">ZipArchiveLib::CDirEnumerator</a></div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;{</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;<span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classCZipArchive.html" title="Represents a zip archive file. ">CZipArchive</a>;</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160; <a class="code" href="classCZipArchive.html" title="Represents a zip archive file. ">CZipArchive</a>* m_pZip;</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160; </div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160; <a class="code" href="structCZipActionCallback.html">CZipActionCallback</a>* m_pMultiCallback;</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160; <span class="keywordtype">int</span> m_iComprLevel;</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160; <span class="keywordtype">int</span> m_iSmartLevel;</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160; <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> m_nBufSize; </div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160; <a class="code" href="classCZipAddFilesEnumerator.html">CZipAddFilesEnumerator</a>(LPCTSTR lpszDirectory, </div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;   <span class="keywordtype">bool</span> bRecursive = <span class="keyword">true</span>, </div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;   <span class="keywordtype">int</span> iComprLevel = -1, </div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;   <span class="keywordtype">int</span> iSmartLevel = <a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fa54480b73a36e09e82defde88ab7a6a38" title="Safe smart (all smartness levels but checking for the compression efficiency).">CZipArchive::zipsmSafeSmart</a>, </div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBufSize = 65536); </div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;<span class="keyword">protected</span>: </div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160; <a class="code" href="classCZipArchive.html" title="Represents a zip archive file. ">CZipArchive</a>* GetZip()</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160; {</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;  <span class="keywordflow">return</span> m_pZip;</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160; }</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> Initialize(<a class="code" href="classCZipArchive.html" title="Represents a zip archive file. ">CZipArchive</a>* pZip)</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160; {</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;  m_pZip = pZip;</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;  m_pMultiCallback = m_pZip-&gt;<a class="code" href="classCZipArchive.html#a068c632e914649df6986477b85eee0b9">GetCallback</a>(<a class="code" href="structCZipActionCallback.html#a987550875690c39c4278cc65e4f11734ac138d3b507f8f349e26e2e85c326bcb4">CZipActionCallback::cbMultiAdd</a>);</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160; }</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;  </div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> UpdateAddNewFileInfo(<a class="code" href="structCZipAddNewFileInfo.html">CZipAddNewFileInfo</a>* )</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160; {</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160; }</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160; <span class="keywordtype">bool</span> <a class="code" href="classZipArchiveLib_1_1CDirEnumerator.html#a28216c71ae181d6d758f34075194f423">Process</a>(LPCTSTR lpszPath, <span class="keyword">const</span> <a class="code" href="structZipArchiveLib_1_1CFileInfo.html">ZipArchiveLib::CFileInfo</a>&amp; info); </div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;};</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;</div>
<div class="line"><a name="l03619"></a><span class="lineno"><a class="code" href="classCReplacingAddFilesEnumerator.html"> 3619</a></span>&#160;<span class="keyword">class </span>ZIP_API <a class="code" href="classCReplacingAddFilesEnumerator.html">CReplacingAddFilesEnumerator</a> : <span class="keyword">public</span> <a class="code" href="classCZipAddFilesEnumerator.html">CZipAddFilesEnumerator</a></div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;{</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160; <a class="code" href="classCReplacingAddFilesEnumerator.html">CReplacingAddFilesEnumerator</a>(LPCTSTR lpszDirectory, </div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;   <span class="keywordtype">bool</span> bRecursive = <span class="keyword">true</span>, </div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;   <span class="keywordtype">int</span> iComprLevel = -1, </div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;   <span class="keywordtype">int</span> iSmartLevel = <a class="code" href="classCZipArchive.html#a578cdd94533678eb97c099102eaf669fa54480b73a36e09e82defde88ab7a6a38" title="Safe smart (all smartness levels but checking for the compression efficiency).">CZipArchive::zipsmSafeSmart</a>,</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBufSize = 65536)</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;   :<a class="code" href="classCZipAddFilesEnumerator.html">CZipAddFilesEnumerator</a>(lpszDirectory, bRecursive, iComprLevel, iSmartLevel, nBufSize)</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160; {</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;  </div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160; }</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160; <span class="keywordtype">void</span> UpdateAddNewFileInfo(<a class="code" href="structCZipAddNewFileInfo.html">CZipAddNewFileInfo</a>* info);</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;};</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;<span class="preprocessor">#if (_MSC_VER &gt; 1000) &amp;&amp; (defined ZIP_HAS_DLL)</span></div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;<span class="preprocessor"></span><span class="preprocessor"> #pragma warning (pop)</span></div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;<span class="preprocessor">#endif // !defined(ZIPARCHIVE_ZIPARCHIVE_DOT_H)</span></div>
</div><!-- fragment --></div><!-- contents -->
<hr><address><small>
The ZipArchive Library Copyright &copy;&nbsp;2000 - 2013 Artpol Software - Tadeusz Dracz. Generated at Fri Dec 13 2013 00:05:37.
</small></address>
</body>
</html>
